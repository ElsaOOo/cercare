#!/usr/bin/env node
"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),os=require("os"),fs=require("fs"),marked=require("marked"),globby=require("globby"),TerminalRenderer=require("marked-terminal"),_require=require("commander"),Command=_require.Command,packageInfo=require("../package.json"),program=new Command;marked.setOptions({renderer:new TerminalRenderer});var HOMEDIR=os.homedir(),FILEDIR="".concat(HOMEDIR,"/.carenotes");fs.existsSync(FILEDIR)||fs.mkdirSync(FILEDIR);var findMdByKeyword=function(){var e=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){var n;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,globby(FILEDIR,{expandDirectories:{extensions:["md"]}});case 2:return n=e.sent,n=n.filter(function(e){e=e.replace("".concat(FILEDIR,"/"),"");return e.includes(r)||r.includes(e)}),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();program.version(packageInfo.version).arguments("[keyword]").action(function(){var r=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){var n;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,findMdByKeyword(r);case 4:(n=e.sent).length?n.forEach(function(e,r){e=fs.readFileSync(e,"utf8");console.log("\n"),console.log(marked(e)),r+1!==n.length&&console.log("========================================================================================")}):console.log("暂时没有相关记录哦~\nNo related records temporarily~");case 6:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}()),program.name("care").usage("[input what you want to find]"),program.parse(process.argv);